<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Fresh Okanagan</title>
  <meta name="description" content="Fresh Okanagan">

    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=0"/>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <!-- iPhone ICON -->
    <link href="/img/apple-touch-icon-57x57.png" sizes="57x57" rel="apple-touch-icon-precomposed">
    <!-- iPad ICON-->
    <link href="/img/apple-touch-icon-72x72.png" sizes="72x72" rel="apple-touch-icon-precomposed">
    <!-- iPhone (Retina) ICON-->
    <link href="/img/apple-touch-icon-114x114.png" sizes="114x114" rel="apple-touch-icon-precomposed">
    <!-- iPad (Retina) ICON-->
    <link href="/img/apple-touch-icon-144x144.png" sizes="144x144" rel="apple-touch-icon-precomposed">
    <!-- iPad (portrait) SPLASHSCREEN-->
    <link href="/img/apple-touch-startup-image-768x1004.png" media="(device-width: 768px) and (orientation: portrait)" rel="apple-touch-startup-image">
    <!-- iPad (landscape) SPLASHSCREEN-->
    <link href="/img/apple-touch-startup-image-748x1024.png" media="(device-width: 768px) and (orientation: landscape)" rel="apple-touch-startup-image">
    <!-- iPad (Retina, portrait) SPLASHSCREEN-->
    <link href="/img/apple-touch-startup-image-1536x2008.png" media="(device-width: 1536px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
    <!-- iPad (Retina, landscape) SPLASHSCREEN-->
    <link href="/img/apple-touch-startup-image-1496x2048.png" media="(device-width: 1536px)  and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">

  <link rel=STYLESHEET href="css/normalize.css">
  <link rel=STYLESHEET href="css/foundation.min.css">
  <link rel=STYLESHEET href="css/style.css">
  <link rel=STYLESHEET href="css/app.css">

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="http://www.parsecdn.com/js/parse-1.2.2.min.js"></script>
  <script src="scripts/models.js"></script>
  <script src="scripts/api.js"></script>
  <script src="scripts/facebook_init.js"></script>
  <script src="vendor/fastclick/fastclick.js"></script>
  <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvjmMxm6ATH92dAC_L60M13_u8AHbi2D8&sensor=false">
  </script>
</head>

<body>
  <div class="main-wrapper">
      <header class="header">
          <button class="small button show-filters"><span class="icon-magnifying-glass"></span></button>

          <button class="small button log-in">Log In</button>
      </header>
      <div class="main">
          <section class="filters" role="complementary">

          </section>
          <section class="map-area" role="map">
              <div id="map"></div>
              <button class="add-place"><span class="icon-plus"></span></button>
          </section>
      </div>

  </div>
  <div class="subsection">
      <div class="header">
          <button class="small button log-in">Close</button>
      </div>
      <div>
          <form>
              <legend>Setup your food stand!</legend>
              <div class="profile__pic-wrap">
                  <img class="profile__pic" src="http://placekitten.com/300/300">
              </div>
              <div class="profile__name">
                  <p>Myroslav</p>
                  <p>Pomazan</p>
              </div>
              <div>
                  <label>Pictures</label>
              </div>
              <div>
                  <label>What are you selling?</label>
                  <textarea></textarea>
              </div>
          </form>
      </div>
  </div>


  <script type="text/javascript">
    Parse.initialize("S8glxzOcLDwTgXQyfUZyg4Rm4znbNmBxzSbfHgpI", "LPS4XPWUjfIcNRgpfxoqbkWqybyW9Odfs205mwbn");

    (function() {
        $('.show-filters').on('click', function(e) {
            $('html').toggleClass('menu-open');
        });

        $('.log-in').on('click', function(e) {
            $('html').toggleClass('sub-open');
            facebook.login();
        });

        var addMarkersOnTheMap = function(locations) {
            locations.forEach(function(location) {
                var marker = new google.maps.Marker({
                    position: new google.maps.LatLng(location.get('lat'), location.get('long')),
                    animation: google.maps.Animation.DROP,
                    map: map
                });

                var infowindow = new google.maps.InfoWindow({
                    content: '<h5>'+ location.get('name') +'</h5>' +
                            '<p>'+ location.get('description') + '</p>'
                });

                google.maps.event.addListener(marker, 'click', function() {
                    infowindow.open(map, marker);
                });
            });
        };

        var mapOptions = {
            center: new google.maps.LatLng(49.883611, -119.493333),
            zoom: 12,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false
        };

        var map = new google.maps.Map(document.getElementById("map"), mapOptions);

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position){
                var latitude = position.coords.latitude;
                var longitude = position.coords.longitude;
                var coords = new google.maps.LatLng(latitude, longitude);

                var marker = new google.maps.Marker({
                    position: coords,
                    map: map,
                    title: "Your current location!"
                });

                var infowindow = new google.maps.InfoWindow({
                    content: '<h4>Here I am!</h4>'
                });

                google.maps.event.addListener(marker, 'click', function() {
                    infowindow.open(map, marker);
                });
            });
        }

        col.MapLocation.fetch({
            success: function (data) {
                addMarkersOnTheMap(data);
            }
        });

        window.addEventListener('load', function() {
            new FastClick(document.body);
        }, false);
    })();
  </script>
</body>

</html>
